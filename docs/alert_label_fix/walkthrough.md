# Walkthrough - 災害情報表示 & 震度ラベル修正

## 修正内容

### 1. 災害情報の表示修正
#### [MODIFY] [js/data.js](file:///Users/saki/lab/anken/disaster-prevention-system/js/data.js)

**問題**: シミュレーションデータに `mag` フィールドがなく、震度計算ができなかった

**解決**: 全てのアラートに `mag`（マグニチュード）フィールドを追加
- 地震速報: M5.5
- 大雨警報: M3.5（参考値）
- 津波注意報: M6.1

これにより、JMA APIからのデータ取得が失敗した場合でも、シミュレーションデータで震度等高線が正しく表示されます。

### 2. 震度ラベルの追加
#### [MODIFY] [js/map.js](file:///Users/saki/lab/anken/disaster-prevention-system/js/map.js)

**新機能**: 各等高線（同心円）の上部に震度ラベルを常時表示

**実装内容**:
- **永続的なラベル**: 各円の上端に「震度X」のラベルを配置
- **色分け**: ラベルの背景色は円の色と同じ
- **視認性向上**: 白文字、太字、影付きで見やすく
- **位置計算**: 緯度から自動的に円の上端位置を計算
- **追加情報**: 円をクリックすると震源からの距離も表示

**ラベル仕様**:
```javascript
震度7    - ダークレッド背景
震度6強  - 赤背景
震度6弱  - オレンジレッド背景
震度5強  - オレンジ背景
震度5弱  - 黄色背景
震度4    - ライトオレンジ背景
震度3以下 - 緑/青背景
```

## 視覚的な改善

### Before (修正前)
- 色付きの円のみ、どの円が何の震度かわからない

### After (修正後)
![画像2の状態](file:///Users/saki/.gemini/antigravity/brain/391ca9b2-5397-4815-a27c-e439c371522c/uploaded_image_1_1767192345485.png)
- 各円の上部に「震度X」のラベルが表示される
- 一目でどのエリアが震度何かわかる
- 円をクリックすると「震源から約XXkm」と距離も表示

## 確認方法

1. ブラウザをリロード
2. 地図上の地震マーカー（青いピン）を確認
3. その周りに複数の色付き同心円が表示される
4. **各円の上部に「震度X」のラベルが表示される**ことを確認
5. 円をクリックすると詳細情報（距離）がポップアップ表示される
