# 防災・災害検知システム (Resilience)

## 概要 (Overview)
**Resilience** は、災害時の迅速な情報収集、避難行動のサポート、および日頃の備えを一元管理するために設計されたWebアプリケーション（ダッシュボード）です。
気象庁の警報やハザードマップ、防災グッズのチェックリスト、家族の安否確認機能などを直感的なインターフェースで提供し、ユーザーの防災リテラシー向上と緊急時の判断を支援します。

## 主な機能 (Features)

### 1. 災害情報ダッシュボード
- **複数の災害タイプに対応**: 地震、大雨、大雪、暴風、洪水、土砂災害、台風、津波など10種類の災害を表示
- リアルタイムで地震速報や気象警報を表示します
- 警報レベルに応じた視覚的なアラート通知を行います
- **24時間自動削除**: 24時間経過した災害情報は自動的にリアルタイム表示から削除されます

### 2. 地域ハザードマップ
- **Leaflet.js** を使用したインタラクティブなマップ機能
- 災害タイプ別のアイコン表示（地震は震度ゾーン、気象災害は専用アイコン）
- 避難所、医療機関、給水拠点、土砂災害警戒区域などを地図上にピン表示します
- 震源地から予測震度を等高線で可視化

### 3. 過去の災害履歴 🆕
- **一覧表示**: 過去30日間の災害情報を日付ごとにグループ化して表示
- **履歴マップ**: 過去の災害発生地点を日本地図上にプロット
- **フィルタリング**: 災害種別（地震、大雨、大雪、暴風、洪水、土砂災害）と期間（7日、14日、30日）で絞り込み
- **統計表示**: 災害タイプごとの発生件数をカウンター表示
- 「ここ1ヶ月この地域で地震が多い」などの傾向分析に活用可能

### 4. 防災アクションガイド
- 地震、台風/水害など、災害の種類ごとの具体的な行動指針（Action Guide）を提供します
- 緊急時にとるべき行動をステップバイステップで確認できます
- 統計データに基づく根拠付きの情報を提供

### 5. 備蓄・持ち出し品チェックリスト
- 飲料水、食料、電気・通信、医薬品などの必需品をリスト管理できます
- 全体の達成率をパーセンテージで可視化し、備えの不足を防ぎます

### 6. 緊急連絡先管理
- 家族や関係機関の連絡先をブラウザ内（ローカルストレージ）に保存・管理できます
- 緊急時に素早く電話番号を確認・発信可能です

### 7. 安否確認 (ワンタップ報告)
- 「無事です」「助けてください」などの定型メッセージをワンタップで生成
- 災害時のスムーズな安否連絡をシミュレーションします

## 対応災害タイプ

| アイコン | 災害タイプ | 説明 |
|----------|------------|------|
| 🏚️ | 地震 (Earthquake) | 震度ゾーン表示対応 |
| 🌧️ | 大雨 (Heavy Rain) | 土砂災害警戒 |
| 🌊 | 洪水 (Flood) | 河川氾濫警戒 |
| ❄️ | 大雪 (Heavy Snow) | 交通影響注意 |
| 💨 | 暴風 (Storm) | 飛来物警戒 |
| 🌀 | 台風 (Typhoon) | 総合警戒 |
| 🌪️ | 竜巻 (Tornado) | 緊急避難 |
| 🌊 | 津波 (Tsunami) | 高台避難 |
| ⛰️ | 土砂災害 (Landslide) | 崖崩れ警戒 |
| 🌡️ | 高温 (Heatwave) | 熱中症注意 |

## 技術スタック (Tech Stack)
- **Frontend**: HTML5, CSS3, JavaScript (Vanilla)
- **Map Library**: [Leaflet.js](https://leafletjs.com/)
- **Icons**: [Font Awesome 6](https://fontawesome.com/)
- **Fonts**: Google Fonts (Inter, Noto Sans JP)
- **Storage**: LocalStorage (連絡先データ、災害履歴の保存に使用)
- **API**: 気象庁 地震情報API、気象警報API

## インストールと使用方法 (Setup & Usage)

本プロジェクトは静的なWebサイトとして構成されているため、特別なビルドプロセスは不要です。

### ⚠️ 重要: ローカルサーバーでの起動を推奨

**リアルタイム機能**（気象庁API、ニュースサイト連携など）を正しく動作させるには、**ローカルサーバー経由でのアクセスが必須**です。

#### ローカルサーバーの起動方法

**1. ターミナルでプロジェクトディレクトリに移動**
```bash
cd /path/to/disaster-prevention-system
```

**2. Pythonの組み込みHTTPサーバーを起動**
```bash
python3 -m http.server 8006
```

以下のような出力が表示されれば成功です：
```
Serving HTTP on :: port 8006 (http://[::]:8006/) ...
```

**3. ブラウザでアクセス**

以下のURLをブラウザで開いてください：
```
http://localhost:8006
```

**4. サーバーの停止**

サーバーを終了するには、ターミナルで `Ctrl + C` を押してください。

---

### 代替方法: ファイルを直接開く（機能制限あり）

ローカルサーバーなしでも基本機能は動作しますが、一部の機能（外部API連携など）が制限されます。

**Macのターミナルから:**
```bash
open index.html
```

**または:** `index.html` をダブルクリック

> **注意**: この方法では、ブラウザのセキュリティ制限により、気象庁APIからのリアルタイムデータ取得や外部サイトとの連携が正しく動作しない場合があります。

---

### アプリケーションの機能

起動後、以下の機能が利用できます：

✅ **リアルタイム災害情報** - 気象庁APIから最新の地震・気象警報データを取得  
✅ **複数災害タイプ対応** - 地震、大雨、大雪、暴風、洪水、土砂災害など  
✅ **24時間自動削除** - 古い情報は自動的にリアルタイム表示から削除  
✅ **過去の災害履歴** - 30日間の履歴を一覧・マップで確認可能  
✅ **震度等高線表示** - マグニチュードから予測震度を可視化  
✅ **災害ニュース** - Yahoo!ニュース、NHK、気象庁へのリンク  
✅ **インタラクティブマップ** - 震源地と影響範囲を地図上に表示  
✅ **防災チェックリスト** - 備蓄品の管理  
✅ **行動ガイド** - 災害別の対処法（統計データ付き）

### デモ機能について
- 画面右上の **「Simulation」** ボタンをクリックすると、緊急事態モード（Emergency Mode）のUI・配色をテストできます。

## ディレクトリ構成 (Directory Structure)
```
.
├── assets/         # 画像などの静的リソース
├── css/            # スタイルシート
│   ├── style.css       # メインスタイル
│   └── responsive.css  # レスポンシブ対応
├── js/             # JavaScriptロジック
│   ├── app.js          # アプリケーションのメインロジック
│   ├── api.js          # 気象庁APIとのデータ連携、履歴管理
│   ├── map.js          # 地図表示・操作ロジック
│   └── data.js         # 災害タイプ定義、地域情報、チェックリスト
├── index.html      # メインテンプレート
└── README.md       # 本ドキュメント
```

## データ管理

### LocalStorageに保存されるデータ
| キー | 内容 | 保持期間 |
|------|------|----------|
| `disasterHistory` | 過去の災害履歴 | 最大30日間 |
| `checklistState` | チェックリストの状態 | 永続 |
| `contacts` | 緊急連絡先 | 永続 |

### 災害情報の自動削除
- **リアルタイム表示**: 24時間以上経過した災害は自動的に非表示
- **履歴保存**: 30日間保存され、それ以降は自動削除

## 注意事項 (Notes)
- **気象庁API**: 本システムは気象庁の公開APIからリアルタイムの地震情報を取得します。ただし、APIの利用制限やネットワーク状況により、データ取得に失敗する場合があります。その場合はシミュレーションデータが表示されます。
- **外部サービス連携**: Yahoo!ニュース、NHK、気象庁などの外部サイトへのリンクが含まれています。これらのサイトは本プロジェクトとは独立して運営されています。
- **安否確認機能**: メッセージ送信は、実際の通信機能（LINE APIなど）とは連携しておらず、アラート表示によるデモ動作となります。
- **プロトタイプ**: 本システムは学習・デモ目的のプロトタイプです。実際の災害時には公式の防災情報源を優先してください。

## 開発・カスタマイズ (Development)

### ファイル構成
- `js/api.js` - 気象庁APIとのデータ連携ロジック、履歴管理、24時間フィルタリング
- `js/map.js` - Leaflet.jsを使用した地図表示・震度等高線・災害マーカー
- `js/app.js` - アプリケーションのメインロジック、履歴表示・フィルタリング
- `js/data.js` - 災害タイプ定義、地域情報、チェックリスト、行動ガイドのマスターデータ

### API仕様
- 地震情報API: `https://www.jma.go.jp/bosai/quake/data/list.json`
- 気象警報API: `https://www.jma.go.jp/bosai/warning/data/warning/000.json`

## ライセンス (License)
このプロジェクトはMITライセンスの下で公開されています。
